{% extends "base.html" %}

{% block title %}Bridge Management Dashboard{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h2>ðŸ“Š System Dashboard</h2>
        <hr>

        <div class="row text-center">
            <div class="col-md-3">
                <div class="card p-3 mb-3 bg-light">
                    <h4>Total Bridges</h4>
                    <h1 class="text-primary">{{ total_bridges }}</h1>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card p-3 mb-3 bg-light">
                    <h4>Avg Daily Traffic (Est.)</h4>
                    <h1 class="text-success">{{ avg_daily_traffic | default:0 }}</h1>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card p-3 mb-3 bg-light">
                    <h4>Maint. Completion Rate</h4>
                    <h1 class="text-warning">{{ completion_rate }}%</h1>
                </div>
            </div>
             <div class="col-md-3">
                <div class="card p-3 mb-3 bg-light">
                    <h4>Total Maint. Actions</h4>
                    <h1 class="text-info">{{ total_maintenance_actions }}</h1>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-6">
                <h3>Condition Summary</h3>
                <table class="table table-bordered">
                    <thead>
                        <tr><th>Category</th><th>Count</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Excellent</td><td>{{ condition_stats.excellent }}</td></tr>
                        <tr><td>Very Good</td><td>{{ condition_stats.very_good }}</td></tr>
                        <tr><td>Good</td><td>{{ condition_stats.good }}</td></tr>
                        <tr><td>Fair</td><td>{{ condition_stats.fair }}</td></tr>
                        <tr><td>Poor</td><td>{{ condition_stats.poor }}</td></tr>
                    </tbody>
                </table>
                <p class="text-muted">Filtering for high-risk bridges based on condition and age will be added here for enterprise reporting.</p>
            </div>

            <div class="col-md-6">
                <h3>Recent Maintenance Records</h3>
                <ul class="list-group">
                    {% for record in recent_maintenance %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <a href="{% url 'bridge_detail' record.bridge.pk %}">
                                <strong>{{ record.bridge.name }}</strong> - {{ record.action_type }}
                            </a>
                            <span class="badge bg-secondary rounded-pill">
                                {% if record.is_completed %}Completed{% else %}Scheduled{% endif %}
                            </span>
                        </li>
                    {% empty %}
                        <li class="list-group-item">No recent maintenance activity.</li>
                    {% endfor %}
                </ul>
                <p class="text-end mt-2"><a href="{% url 'bridge_list' %}">View All Bridges</a></p>
            </div>
        </div>
    </div>
{% endblock %}
